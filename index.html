<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Odjezdy MHD</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body { font-family: sans-serif; background:#f0f0f0; color:#333; text-align:center; margin:20px; }
  h1 { font-size:24px; }
  .toggle-container {
    display: inline-block;
    position: relative;
    width: 60px;
    height: 30px;
    margin: 20px;
  }
  .toggle-container input {
    display: none;
  }
  .slider {
    position: absolute;
    cursor: pointer;
    top: 0; left: 0;
    right: 0; bottom: 0;
    background-color: #c00;
    -webkit-transition: .4s;
    transition: .4s;
    border-radius: 34px;
  }
  .slider:before {
    position: absolute;
    content: "";
    height: 22px;
    width: 22px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    -webkit-transition: .4s;
    transition: .4s;
    border-radius: 50%;
  }
  input:checked + .slider {
    background-color: #fc0;
  }
  input:checked + .slider:before {
    -webkit-transform: translateX(30px);
    -ms-transform: translateX(30px);
    transform: translateX(30px);
  }
  .departures {
    margin-top: 20px;
  }
  .card {
    background:#fff; padding:10px; margin:10px auto; max-width:300px; border-radius:5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    text-align:left;
  }
  .line {
    display:inline-block;
    width:40px;
    height:30px;
    line-height:30px;
    text-align:center;
    background:#3b82f6;
    color:#fff;
    font-weight:bold;
    border-radius:4px;
  }
  .headsign { margin-left:10px; font-weight:bold; }
  .time { float:right; font-size:16px; }
</style>
</head>
<body>

<h1>Odjezdy MHD</h1>

<!-- Toggle -->
<div>
  <span style="font-size:24px;">üöã</span>
  <label class="toggle-container">
    <input type="checkbox" id="modeToggle">
    <span class="slider"></span>
  </label>
  <span style="font-size:24px;">üöå</span>
</div>

<div id="departures" class="departures">Naƒç√≠t√°m odjezdy‚Ä¶</div>

<script>
  var apiKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MzcxMiwiaWF0IjoxNzUwNTE1NjQxLCJleHAiOjExNzUwNTE1NjQxLCJpc3MiOiJnb2xlbWlvIiwianRpIjoiMWRlNWRmNzktNDE0My00NjM0LTljOGItYzMzYzUxYjJkMmJhIn0.eoiW2CqdFEv6qZBEd-_7_L2rHGj-nZlxAfsK7YcLRmY"; // replace with your token
  var stopId = "U266Z1P";

  function loadDepartures() {
    var xhr = new XMLHttpRequest();
    var url = "https://api.golemio.cz/v2/pid/departureboards?ids=" + stopId + "&minutesAfter=60";
    xhr.open("GET", url, true);
    xhr.setRequestHeader("Accept", "application/json");
    xhr.setRequestHeader("X-Access-Token", apiKey);

    xhr.onreadystatechange = function() {
      if (xhr.readyState == 4) {
        var container = document.getElementById("departures");
        if (xhr.status == 200) {
          var data = JSON.parse(xhr.responseText);
          if (data.departures.length === 0) {
            container.innerHTML = "≈Ω√°dn√© odjezdy.";
          } else {
            var html = "";
            for (var i=0; i<data.departures.length; i++) {
              var dep = data.departures[i];
              var d = new Date(dep.departure_timestamp.predicted);
              var time = (d.getHours()<10?"0":"") + d.getHours() + ":" + (d.getMinutes()<10?"0":"") + d.getMinutes();
              var color = "#3b82f6";
              if (dep.route.short_name == "9") color="#009ee0";
              if (dep.route.short_name == "11") color="#02964f";
              if (dep.route.short_name == "31") color="#808080";
              html += '<div class="card">' +
                      '<div class="line" style="background:'+color+';">'+ dep.route.short_name +'</div>' +
                      '<span class="headsign">'+ dep.trip.headsign +'</span>' +
                      '<span class="time">'+time+'</span>' +
                      '</div>';
            }
            container.innerHTML = html;
          }
        } else {
          container.innerHTML = "Chyba naƒç√≠t√°n√≠ dat.";
        }
      }
    };
    xhr.send();
  }

  var toggle = document.getElementById("modeToggle");
  toggle.onclick = function() {
    if (toggle.checked) {
      stopId = "U694Z3P"; // bus
    } else {
      stopId = "U266Z1P"; // tram
    }
    loadDepartures();
  };

  loadDepartures();
  setInterval(loadDepartures, 30000);
</script>

</body>
</html>
